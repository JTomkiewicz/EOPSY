#!/usr/local/bin/bash

# default options
do_recursion=false
do_lower=false
do_upper=false
do_sed_pattern=true

# get options from command line
while getopts rluh option
do 
    case "${option}"
        in
        r) 
            # recursion
            do_recursion=true
            ;;
        l) 
            # lowerizing
            do_lower=true
            do_sed_pattern=false
            ;;
        u) 
            #uppercasing
            do_upper=true
            do_sed_pattern=false
            ;;
        h) 
            #help
            echo "Example usage:"
            echo "modify [OPTION] [SED PATTERN] <dir/file names...>"
            echo "Program modifies file names."
            echo 
            echo "Options:"
            echo "-r   use recursion"
            echo "-l   lowerizing file names"
            echo "-u   uppercasing file names"
            echo "-h   display help"
            # end program
            exit
            ;;
        ?) 
            # other
            echo "Unknown option. Use -h for help."
            # end program
            exit
            ;;
    esac
done

# remove all options that have been parsed by getopts
shift "$((OPTIND-1))"

# see if parameters are correct
if $do_upper && $do_lower; then
    echo "Incorrect options. Use -h for help."
    # end program
    exit
fi

# if sed pattern is needed, check if it exist
if $do_sed_pattern; then 
    if [ $# = 0 ]; then
        echo "Missing sed pattern. Use -h for help."
        exit
    fi 

    sed_pattern="$1"
fi

# internal field separator
IFS=$'\n'

# check if file exist
for args in "$@"
do 
    # -e NOT -f, as we are looking for name regardless of the type
    if [ ! -e "$args" ]; then
		echo "Missing file. Use -h for help."
		exit
	fi
done
